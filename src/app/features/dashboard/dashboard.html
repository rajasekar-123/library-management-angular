<div class="dashboard-container">

  
  <mat-card class="dashboard-header">
    <mat-card-title>Dashboard</mat-card-title>
    <mat-card-subtitle>
      Welcome, <b>{{ user.name || user.email }}</b>
    </mat-card-subtitle>
  </mat-card>


  <div class="stats-grid">


    <mat-card class="stat-card users" *ngIf="auth.isAdmin()" (click)="onTotalUsersClick()">
      <mat-icon>group</mat-icon>
      <div>
        <h3>Total Users</h3>
        <p>{{ totalUsers }}</p>
      </div>
    </mat-card>


    <mat-card class="stat-card books" (click)="onTotalBooksClick()">
      <mat-icon>menu_book</mat-icon>
      <div>
        <h3>Total Books</h3>
        <p>{{ totalBooks }}</p>
      </div>
    </mat-card>


    <mat-card class="stat-card taken" (click)="onTakenBooksClick()">
      <mat-icon>library_add</mat-icon>
      <div>
        <h3>Taken Books</h3>
        <p>{{ takenBooks }}</p>
      </div>
    </mat-card>

  
    <mat-card class="stat-card taken" (click)="onMyBooksClick()">
      <mat-icon>library_books</mat-icon>
      <div>
        <h3>Books Taken By Me</h3>
        <p>{{ takenbyme }}</p>
      </div>
    </mat-card>


    <mat-card class="stat-card returned" *ngIf="auth.isAdmin()" (click)="onReturnedBooksClick()">
      <mat-icon>assignment_return</mat-icon>
      <div>
        <h3>Returned Books</h3>
        <p>{{ returnedbooks }}</p>
      </div>
    </mat-card>

  </div>
  
  <!-- Standalone Components Section -->
  <!-- Standalone Components Section Removed - Now using separate routes -->


  <mat-card *ngIf="auth.isAdmin()" class="admin-history-card">
    <mat-card-title> Book Transaction History</mat-card-title>

    <table border="1" width="100%" cellpadding="8">
      <tr>
        <th>User Email</th>
        <th>Book Title</th>
        <th>Taken Date</th>
        <th>Return Date</th>
        <th>Status</th>
      </tr>

      <tr *ngFor="let t of transactions">
        <td>{{ t.userEmail }}</td>
        <td>{{ t.bookTitle }}</td>
        <td>{{ t.takenDate | date:'medium' }}</td>
        <td>
          {{ t.returnDate ? (t.returnDate | date:'medium') : 'â€”' }}
        </td>
        <td>
          <b [style.color]="t.status === 'RETURNED' ? 'green' : 'orange'">
            {{ t.status }}
          </b>
        </td>
      </tr>
    </table>

    <div *ngIf="transactions.length === 0" style="margin-top:10px">
      No transaction records found
      <br><br>
      <button mat-raised-button color="accent" (click)="createSampleData()">
        <mat-icon>add</mat-icon>
        Create Sample Data
      </button>
    </div>

    <div *ngIf="transactions.length > 0" style="margin-top:10px">
      <button mat-stroked-button color="warn" (click)="clearSampleData()">
        <mat-icon>delete</mat-icon>
        Clear All Transactions
      </button>
    </div>
  </mat-card>


  <mat-card class="action-card">
    <div class="actions">

      <button mat-raised-button color="primary" routerLink="/books">
        <mat-icon>menu_book</mat-icon>
        Books
      </button>

      <button mat-stroked-button color="warn" (click)="logout()">
        <mat-icon>logout</mat-icon>
        Logout
      </button>

      <button mat-stroked-button color="accent" (click)="resetAllData()" *ngIf="auth.isAdmin()">
        <mat-icon>refresh</mat-icon>
        Reset All Data
      </button>

    </div>
  </mat-card>

</div>
